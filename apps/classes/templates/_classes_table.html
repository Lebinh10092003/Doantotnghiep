<div class="dataTable-container table-responsive">
  <table class="table table-striped dataTable-table">
    <thead>
      <tr>
        <th>Tên lớp</th>
        <th>Trung tâm</th>
        <th>Môn học</th>
        <th>Giáo viên chính</th>
        <th>Ngày bắt đầu</th>
        <th>Trạng thái</th>
        <th>Hành động</th>
      </tr>
    </thead>
    <tbody>
      {% for klass in page_obj.object_list %}
      <tr>
        <td>{{ klass.name }}</td>
        <td>{% if klass.center %}{{ klass.center.name }}{% else %}-{% endif %}</td>
        <td>{% if klass.subject %}{{ klass.subject.name }}{% else %}-{% endif %}</td>
        <td>{% if klass.main_teacher %}{{ klass.main_teacher.get_full_name|default:klass.main_teacher.username }}{% else %}-{% endif %}</td>
        <td>{{ klass.start_date|date:"d/m/Y"|default:"-" }}</td>
        <td>
          {% if klass.status == 'PLANNED' %}
            <span class="badge bg-info">{{ klass.get_status_display }}</span>
          {% elif klass.status == 'ONGOING' %}
            <span class="badge bg-success">{{ klass.get_status_display }}</span>
          {% elif klass.status == 'COMPLETED' %}
            <span class="badge bg-secondary">{{ klass.get_status_display }}</span>
          {% else %}
            <span class="badge bg-danger">{{ klass.get_status_display }}</span>
          {% endif %}
        </td>
        <td class="text-nowrap">
          <div class="d-flex gap-1">
            <button type="button" class="btn btn-sm btn-info" title="Xem chi tiết"
               hx-get="{% url 'classes:class_detail' klass.pk %}"
               hx-target="#classes-modal-content"
               data-bs-toggle="modal" data-bs-target="#classes-modal"
               @click="modalTitle = 'Chi tiết Lớp học: {{ klass.name|escapejs }}'">
                <i class="bi bi-eye"></i>
            </button>
            {% if perms.classes.change_class %}
            <button type="button" class="btn btn-sm btn-warning" title="Chỉnh sửa"
               hx-get="{% url 'classes:class_edit' klass.pk %}"
               hx-target="#classes-modal-content"
               data-bs-toggle="modal" data-bs-target="#classes-modal"
               @click="modalTitle = 'Cập nhật Lớp học: {{ klass.name|escapejs }}'">
                <i class="bi bi-pencil-square"></i>
            </button>
            {% endif %}
            {% if perms.classes.delete_class %}
            <button type="button" class="btn btn-sm btn-danger" title="Xóa"
               hx-post="{% url 'classes:class_delete' klass.pk %}" hx-swap="none"
               data-confirm-title="Xác nhận xóa" data-confirm-text="Bạn chắc chắn muốn xóa lớp '{{ klass.name|escapejs }}'?"><i class="bi bi-trash"></i></button>
            {% endif %}
          </div>
        </td>
      </tr>
      {% empty %}
      <tr><td colspan="7" class="text-center">Không tìm thấy lớp học nào khớp.</td></tr>
      {% endfor %}
    </tbody>
  </table>
</div>

<div class="dataTable-bottom d-flex justify-content-between align-items-center">
  <div class="dataTable-info">
    Hiện {{ page_obj.start_index }} đến {{ page_obj.end_index }} trong tổng số {{ paginator.count }} mục
  </div>

  {% if page_obj.has_other_pages %}
  <nav class="dataTable-pagination">
    <ul class="pagination">
      {% if page_obj.has_previous %}
      <li class="page-item">
        <a class="page-link" href="?page=1&{{ current_query_params }}" hx-get="?page=1&{{ current_query_params }}" hx-target="#{{ target_id|default:'filterable-content' }}" hx-swap="innerHTML" hx-push-url="true">Đầu</a>
      </li>
      {% endif %}

      {% for i in paginator.page_range %}
        {% if i >= page_obj.number|add:'-2' and i <= page_obj.number|add:'2' %}
          <li class="page-item {% if page_obj.number == i %}active{% endif %}"><a class="page-link" href="?page={{ i }}&{{ current_query_params }}" hx-get="?page={{ i }}&{{ current_query_params }}" hx-target="#{{ target_id|default:'filterable-content' }}" hx-swap="innerHTML" hx-push-url="true">{{ i }}</a></li>
        {% endif %}
      {% endfor %}

      {% if page_obj.has_next %}
      <li class="page-item"><a class="page-link" href="?page={{ paginator.num_pages }}&{{ current_query_params }}" hx-get="?page={{ paginator.num_pages }}&{{ current_query_params }}" hx-target="#{{ target_id|default:'filterable-content' }}" hx-swap="innerHTML" hx-push-url="true">Cuối</a></li>
      {% endif %}
    </ul>
  </nav>
  {% endif %}
</div>