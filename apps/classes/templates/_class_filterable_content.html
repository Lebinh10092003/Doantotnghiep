{% include "_filter_ui_controls.html" with filter=filter active_filter_name=active_filter_name model_name=model_name current_query_params=current_query_params active_filter_badges=active_filter_badges target_id='filterable-content' %}

<div class="d-flex flex-wrap justify-content-between align-items-center gap-2 mb-2">
  <form id="class-group-by-form"
        class="d-flex align-items-center gap-2"
        hx-get="{% url 'classes:manage_classes' %}"
        hx-target="#filterable-content"
        hx-swap="innerHTML"
        hx-push-url="true"
        hx-include="#filter-form"
        hx-trigger="change from:#class-group-by-select"
        hx-vals='{"page":"1"}'>
    <label for="class-group-by-select" class="mb-0 small text-muted fw-semibold">Nhóm theo</label>
    <select id="class-group-by-select"
            name="group_by"
            class="form-select form-select-sm"
            onchange="window.syncClassGroupBy && window.syncClassGroupBy(this.value)">
      <option value="" {% if not group_by %}selected{% endif %}>Không nhóm</option>
      <option value="subject" {% if group_by == 'subject' %}selected{% endif %}>Môn học</option>
      <option value="center" {% if group_by == 'center' %}selected{% endif %}>Trung tâm</option>
      <option value="teacher" {% if group_by == 'teacher' %}selected{% endif %}>Giáo viên</option>
      <option value="status" {% if group_by == 'status' %}selected{% endif %}>Trạng thái</option>
      <option value="timeslot" {% if group_by == 'timeslot' %}selected{% endif %}>Khung giờ</option>
    </select>
  </form>

  <div class="dataTable-dropdown d-flex align-items-center gap-2 mb-0">
    <select name="per_page"
            class="dataTable-selector form-select form-select-sm w-auto"
            hx-get="{% url 'classes:manage_classes' %}"
            hx-target="#filterable-content"
            hx-swap="innerHTML"
            hx-push-url="true"
            hx-include="#filter-form"
            hx-trigger="change"
            hx-vals='{"page":"1"}'>
      <option value="5" {% if per_page == 5 %}selected{% endif %}>5</option>
      <option value="10" {% if per_page == 10 %}selected{% endif %}>10</option>
      <option value="25" {% if per_page == 25 %}selected{% endif %}>25</option>
      <option value="50" {% if per_page == 50 %}selected{% endif %}>50</option>
    </select>
    <label class="mb-0">mục trên trang</label>
  </div>
</div>

<div id="class-table-container" 
     class="dataTable-wrapper dataTable-loading no-footer sortable searchable fixed-columns"
     hx-trigger="reload-classes-table from:body" hx-swap="innerHTML">
  {% include "_classes_table.html" with page_obj=page_obj paginator=paginator per_page=per_page current_query_params=current_query_params target_id='filterable-content' group_by=group_by %}
</div>
