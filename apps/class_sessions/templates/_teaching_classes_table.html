{% load group_tags %}

<div class="dataTable-container table-responsive">
  <table class="table table-striped dataTable-table">
    <thead>
      <tr>
        <th>Mã lớp</th>
        <th>Tên lớp</th>
        <th>Môn</th>
        <th>Trung tâm</th>
        <th>GV chính</th>
        <th>Trợ giảng</th>
        <th>Trạng thái</th>
        <th>Ngày bắt đầu</th>
        <th>Ngày kết thúc</th>
      </tr>
    </thead>
    <tbody>
      {% for c in classes %}
      <tr>
        <td>{{ c.code }}</td>
        <td>
          {% if perms.classes.view_class %}
            {% if user|in_group:"TEACHER" or user|in_group:"ASSISTANT" %}
              <a href="#"
                 hx-get="{% url 'classes:class_detail' c.pk %}"
                 hx-target="#sessions-modal-content"
                 data-bs-toggle="modal"
                 data-bs-target="#sessions-modal"
                 @click="modalTitle = 'Chi tiết Lớp: {{ c.name|escapejs }}'"
                 title="Chi tiết lớp">
                {{ c.name }}
              </a>
            {% else %}
              {{ c.name }}
            {% endif %}
          {% else %}
            {{ c.name }}
          {% endif %}
        </td>
        <td>{{ c.subject.name }}</td>
        <td>{{ c.center.name }}</td>
        <td>{{ c.main_teacher.get_full_name|default:c.main_teacher.username }}</td>
        <td>
          {% for a in c.assistants.all %}
            <span class="badge bg-light text-dark border me-1">
              {{ a.get_full_name|default:a.username }}
            </span>
          {% empty %}
            <span class="text-muted">-</span>
          {% endfor %}
        </td>
        <td>{{ c.get_status_display }}</td>
        <td>{{ c.start_date|date:"d/m/Y"|default:"-" }}</td>
        <td>{{ c.end_date|date:"d/m/Y"|default:"-" }}</td>
      </tr>
      {% empty %}
      <tr>
        <td colspan="9" class="text-center text-muted">Không có lớp nào phù hợp.</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
