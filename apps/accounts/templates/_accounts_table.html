{# apps/accounts/templates/accounts/_accounts_table.html #}
<table class="table table-striped dataTable-table" id="table1">
  <thead>
    <tr>
      <th>Name</th>
      <th>Email</th>
      <th>Phone</th>
      <th>City</th>
      <th>Status</th>
    </tr>
  </thead>
  <tbody>
    {% if group_by == "role" %}
      {% regroup page_obj.object_list by groups.all.0.name as role_list %}
      {% for group in role_list %}
        <tr class="table-group">
          <td colspan="5"><strong>{{ group.grouper|default:"(No role)" }}</strong></td>
        </tr>
        {% for user in group.list %}
          <tr>
            <td>{{ user.get_full_name }}</td>
            <td>{{ user.email }}</td>
            <td>{{ user.phone }}</td>
            <td>{{ user.profile.city|default:"" }}</td>
            <td>
              {% if user.is_active %}
                <span class="badge bg-success">Active</span>
              {% else %}
                <span class="badge bg-danger">Inactive</span>
              {% endif %}
            </td>
          </tr>
        {% endfor %}
      {% endfor %}
    {% else %}
      {% for user in page_obj.object_list %}
      <tr>
        <td>{{ user.get_full_name }}</td>
        <td>{{ user.email }}</td>
        <td>{{ user.phone }}</td>
        <td>{{ user.profile.city|default:"" }}</td>
        <td>
          {% if user.is_active %}
            <span class="badge bg-success">Active</span>
          {% else %}
            <span class="badge bg-danger">Inactive</span>
          {% endif %}
        </td>
      </tr>
      {% empty %}
      <tr><td colspan="5">No users</td></tr>
      {% endfor %}
    {% endif %}
  </tbody>
</table>

<div class="dataTable-bottom d-flex justify-content-between align-items-center">
  <div class="dataTable-info">Showing {{ page_obj.start_index }} to {{ page_obj.end_index }} of {{ paginator.count }} entries</div>
  <nav class="dataTable-pagination">
    <ul class="pagination">
      {% for p in paginator.page_range %}
        <li class="page-item {% if page_obj.number == p %}active{% endif %}">
          <a 
            hx-get="{% url 'accounts:manage_accounts' %}?page={{ p }}&per_page={{ per_page }}&q={{ q }}&status={{ status }}&role={{ role }}&group_by={{ group_by }}" 
            hx-target="#accounts-table" 
            hx-swap="innerHTML"
            class="page-link">{{ p }}</a>
        </li>
      {% endfor %}
    </ul>
  </nav>
</div>
