{% include "_filter_ui_controls.html" with filter=filter active_filter_name=active_filter_name model_name=model_name current_query_params=current_query_params active_filter_badges=active_filter_badges target_id='accounts-filterable-content' %}

<div class="d-flex flex-wrap justify-content-between align-items-center gap-2 mb-2">
  <form id="account-group-by-form"
        class="d-flex align-items-center gap-2"
        hx-get="{% url 'accounts:manage_accounts' %}"
        hx-target="#accounts-filterable-content"
        hx-swap="innerHTML"
        hx-push-url="true"
        hx-include="#filter-form"
        hx-trigger="change from:#account-group-by-select"
        hx-vals='{"page":"1"}'>
    <label for="account-group-by-select" class="mb-0 small text-muted fw-semibold">Nhóm theo</label>
    <select id="account-group-by-select"
            name="group_by"
            class="form-select form-select-sm"
            onchange="window.syncAccountGroupBy && window.syncAccountGroupBy(this.value)">
      <option value="" {% if not group_by %}selected{% endif %}>Không nhóm</option>
      <option value="role" {% if group_by == 'role' %}selected{% endif %}>Nhóm theo vai trò</option>
      <option value="center" {% if group_by == 'center' %}selected{% endif %}>Nhóm theo trung tâm</option>
    </select>
  </form>

  <div class="dataTable-dropdown d-flex align-items-center gap-2 mb-0">
    <select name="per_page"
            class="dataTable-selector form-select form-select-sm w-auto"
            hx-get="{% url 'accounts:manage_accounts' %}"
            hx-target="#accounts-filterable-content"
            hx-swap="innerHTML"
            hx-push-url="true"
            hx-include="#filter-form"
            hx-trigger="change"
            hx-vals='{"page":"1"}'>
      <option value="10" {% if per_page == 10 %}selected{% endif %}>10</option>
      <option value="25" {% if per_page == 25 %}selected{% endif %}>25</option>
      <option value="50" {% if per_page == 50 %}selected{% endif %}>50</option>
      <option value="100" {% if per_page == 100 %}selected{% endif %}>100</option>
    </select>
    <label class="mb-0">mục trên trang</label>
  </div>
</div>

<div class="dataTable-wrapper dataTable-loading no-footer sortable searchable fixed-columns">
  <form id="accounts-table-form">
    {% csrf_token %}
    {% include "_accounts_table.html" with page_obj=page_obj paginator=paginator per_page=per_page current_query_params=current_query_params target_id='accounts-filterable-content' group_by=group_by %}
  </form>
</div>
